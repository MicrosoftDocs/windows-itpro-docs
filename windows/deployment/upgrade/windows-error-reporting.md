---
title: Windows error reporting - Windows IT Pro
manager: aaroncz
ms.author: frankroj
description: Learn how to review the events generated by Windows Error Reporting when something goes wrong during Windows setup.
ms.service: windows-client
author: frankroj
ms.localizationpriority: medium
ms.topic: article
ms.subservice: itpro-deploy
ms.date: 01/18/2024
appliesto:
  - ✅ <a href="https://learn.microsoft.com/windows/release-health/supported-versions-windows-client" target="_blank">Windows 11</a>
  - ✅ <a href="https://learn.microsoft.com/windows/release-health/supported-versions-windows-client" target="_blank">Windows 10</a>
---

# Windows Error Reporting

> [!NOTE]
>
> The following is a level 300 (moderate advanced) topic. See [Resolve Windows upgrade errors](resolve-windows-upgrade-errors.md) for a full list of articles in this section.

When Windows Setup fails, the result and extend code are recorded as an informational event in the Application log by Windows Error Reporting as event 1001. The event name is **WinSetupDiag02**.  Event Viewer or Windows PowerShell can be used to review this event.

To use Windows PowerShell, type the following commands from an elevated Windows PowerShell prompt:

> [!IMPORTANT]
>
> The following Event logs are only available if Windows was updated from a previous version of Windows to a new version of Windows.

```powershell
$events = Get-WinEvent -FilterHashtable @{LogName="Application";ID="1001";Data="WinSetupDiag02"}
$event = [xml]$events[0].ToXml()
$event.Event.EventData.Data
```

To use Event Viewer:

1. Open Event Viewer and navigate to **Windows Logs\Application**.
1. Select **Find**, and then search for **winsetupdiag02**.
1. Double-click the event that is highlighted.

> [!NOTE]
>
> For legacy operating systems, the Event Name was WinSetupDiag01.

Ten parameters are listed in the event:

| Index  | Meaning | Possible values |
| ------ | ------- | --------------- |
| P1     | The setup scenario | 1=Media, 5=Windows Update, 7=Media Creation Tool |
| P2     | Setup mode | x=default, 1=Downlevel, 5=Rollback |
| P3     | New OS architecture | x=default, 0=X86, 9=AMD64 |
| P4     | Installation result | x=default, 0=Succeeded, 1=Failed, 2=Cancelled, 3=Blocked |
| **P5** | **Result Error Code** | e.g., 0xc1900101 |
| **P6** | **Extend Error Code** | e.g., 0x20017 |
| P7     | Source OS build | e.g., 9600 |
| P8     | Source OS branch (not typically available) |  |
| P9     | New OS build | e.g., 16299 |
| P10    | New OS branch | e.g., `rs3_release` |

The event also contains links to log files that can be used to perform a detailed diagnosis of the error. The following example is an example of this event from a successful upgrade:

:::image type="content" alt-text="Windows Error Reporting." source="../images/event.png" lightbox="../images/event.png":::

## Related articles

- [Fix Windows Update errors by using the DISM or System Update Readiness tool](/troubleshoot/windows-server/deployment/fix-windows-update-errors).
